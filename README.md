# Caves & Catastrophes

A compact, keyboard-driven roguelike written in C. Explore procedurally generated forests, multi-level caves and multi-dimensional realms; fight monsters and bosses, collect loot, craft weapons, complete quests and level up.

This project began because I was bored during programming class — a blank file and some RNG experiments turned into this little chaotic adventure.

---

## Table of contents
- [Quick summary](#quick-summary)  
- [What the game contains](#what-the-game-contains)  
- [Key feature — Procedural generation](#key-feature---procedural-generation)  
- [How to play (quick)](#how-to-play-quick)  
- [Build & run (quick start)](#build--run-quick-start)  
- [If you don't want to compile](#if-you-dont-want-to-compile)  
- [Troubleshooting & notes](#troubleshooting--notes)  
- [Developer notes & extending](#developer-notes--extending)  
- [Contributing](#contributing)  
- [License & credits](#license--credits)  
- [Future updates](#future-updates)

---

## Quick summary
- Platform: console / terminal (Windows-first; POSIX supported with a small shim)  
- Source: `main.c` (single-file C program)  
- Play style: keyboard-only, single-key prompts (no Enter needed for many choices).  
- One-liner: Explore procedural caves & realms, fight, loot, craft, quest, survive.

---

## What the game contains
- Multi-depth cave system (5 levels; each level is a 5×5 grid)
  - Stairs up/down, merchants, NPCs, treasure rooms, enemy rooms and bosses
  - Final exit portal on deepest level with special rewards
- Multi-dimensional realms (Fire, Ice, Shadow) — each is a 4×4 grid
  - Realm-specific enemies, treasures, a guaranteed realm boss and permanent rewards
- Turn-based combat (attack, defend, special attack, potions, flee)
- Inventory: weapons, potions, magic scrolls
- Shops (town & wandering cave merchants) and crafting station (recipes included)
- Quest system and NPC interactions
- Save system: quick save, multiple slots, autosave and backup saves
- UX: ASCII headers, boxed messages, typewriter-style text for flavor

---

## Key feature — Procedural generation
Everything is generated by RNG at runtime for replayability. Examples:
- Cave maps & room contents: stairs, exits, monsters, merchants, NPCs, treasures, bosses
- Weapons: generated names, attack, level, durability and value
- Enemies & bosses: randomized stats, champion variants, rewards scaled by depth
- NPCs & dialog: selection of types, lines and occasional gifts/quests
- Random events: wandering merchants, ambushes, lucky finds, fountains
- Encounters & numeric values are scaled by player level and location

---

## How to play (quick)
Main menu
- `1` — Start New Game  
- `2` — Help & Guide  
- `3` — Credits  
- `4` — Load Game  
- `Q` — Quit

In-game (main actions)
- `1` — Explore the forest (random encounters)  
- `2` — Enter the cave system (procedural dungeon)  
- `3` — Rest and recover (risk: ambush)  
- `4` — Check inventory (equip/use potions & scrolls)  
- `5` — View quests  
- `6` — Skill tree (spend skill points)  
- `7` — Visit town (NPCs, shop, crafting)  
- `8` — Save/Load Game  
- `9` — Exit to main menu

Cave navigation (while exploring)
- `W` — North, `S` — South, `A` — West, `D` — East  
- `J` — Descend stairs (when present)  
- `U` — Ascend stairs (when present)  
- `M` — Show map, `I` — Inventory  
- `R` — Rest (heal but risk ambush)  
- `X` — Escape (only on deepest-level exit room)  
- `Q` — Quit cave (return to entrance)

Combat
- `1` — Attack  
- `2` — Defend  
- `3` — Special Attack (uses mana)  
- `4` — Use Potion  
- `5` — Flee (chance varies with depth / enemy)

> Note: the code historically referenced Ctrl+X / Ctrl+Y (control codes 24/25) for stairs — terminal handling varies. J/U are the reliable keys used in the current implementation.

---

## Build & run — quick start

### Windows (recommended)
- Using MinGW / MSYS2 / MinGW-w64:
```bash
gcc main.c -o CAVES_AND_CATASTROPHES.exe -std=c99 -O2 -Wall
./CAVES_AND_CATASTROPHES.exe
```
- Visual Studio: add `main.c` to a Console Application project and build.

### POSIX (Linux / macOS)
POSIX lacks `<conio.h>`. Add this `_getch()` shim to `main.c` (guarded with `#ifndef _WIN32`):

```c
#ifndef _WIN32
#include <termios.h>
#include <unistd.h>

static int _getch(void) {
    struct termios oldt, newt;
    tcgetattr(STDIN_FILENO, &oldt);
    newt = oldt;
    newt.c_lflag &= ~(ICANON | ECHO);
    tcsetattr(STDIN_FILENO, TCSANOW, &newt);
    int ch = getchar();
    tcsetattr(STDIN_FILENO, TCSANOW, &oldt);
    return ch;
}
#endif
```

Then:
```bash
gcc main.c -o caves_and_catastrophes -std=c99 -O2 -Wall
./caves_and_catastrophes
```

---

## If you don't want to compile (or you're lazy)
If you lack programming experience or just don't want to bother manually compiling, run the included Windows helper:
- `autoCompile.bat` — double-click it or run it in a Command Prompt. It will attempt to compile `main.c` with GCC and produce `CAVES_AND_CATASTROPHES.exe` and log output to `compile.log`. The script will also try to embed `img\logo\logo.ico` if present.

---

## Troubleshooting & notes
- Missing `conio.h` on POSIX: add the `_getch()` shim shown above.  
- `autoCompile.bat` fails: likely GCC/MinGW missing — install MSYS2 / MinGW-w64 or compile manually. Check `compile.log` for details.  
- Save compatibility: saves are binary and tied to `main.c` struct layout — changing structures can invalidate old saves.  
- Control characters: terminal behavior for control codes (Ctrl+X/Ctrl+Y) varies — use J/U where available.  
- If single-key input echoes on POSIX, confirm the `_getch()` shim is compiled.

---

## Developer notes & where to look in `main.c`
`main.c` is organized by subsystem functions. Useful entry points:
- Cave system: `caveWanderingSystem`, `generateCave`, `displayCaveMap`  
- Realms: `initRealms`, `generateRealm`, `realmWanderingSystem`, `spawnRealmEnemy`  
- Combat: `caveEncounterEnemy`, `bossBattle`, `spawnBoss`, `spawnDepthBoss`  
- Items & shops: `generate_weapon`, `initShop`, `visitShop`  
- Crafting: `initCrafting`, `craftingSystem`  
- Quests & progression: `initQuests`, `updateQuestProgress`, `checkQuestCompletion`  
- Saving: `saveGame`, `loadGame`, `saveGameToSlot`, `loadGameFromSlot`, `autoSaveGame`

---

## Extending ideas
- Port input to `ncurses` or a GUI for consistent terminal behavior.  
- Add JSON/text saves for portability and easier debugging.  
- Expand procedural pools: more prefixes, suffixes, enemy types, special room effects.  
- Refactor `main.c` into modules (`cave.c`, `combat.c`, `save.c`, `ui.c`) for maintainability.

---

## Contributing
This is a hobby project. Contributions welcome:
- Fork, implement focused changes (bugfixes, portability, new content), and open a pull request.  
- If you change save formats or core structures, document migrations in the PR.

---

## License & credits
- Developed by Carl Harvey Miguel (DoodleSaurus)  
- License: Creative Commons Attribution‑NoDerivatives 4.0 International (CC BY‑ND 4.0). See `LICENSE` for details.

---

## Future updates
This project is actively maintained and will continue to receive updates — expect new weapons, enemies, rooms, quests, quality-of-life improvements and other features in future releases.

---

Enjoy the unpredictable — every delve is a new story.
